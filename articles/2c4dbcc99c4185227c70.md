---
title: "SpreadSheetã§GoogleAnalyticsã®æ•°å€¤ã‚’å–å¾—ã™ã‚‹ã¨ãã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ»ãƒªãƒ³ã‚¯é›†"
emoji: "ðŸ¦”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["SpreadSheet","GoogleAnalytics"]
published: true
---

â€»qiitaã‹ã‚‰ç§»è¡Œã—ã¾ã—ãŸ
https://qiita.com/KogaAkito/items/4b2e282309a8cf75e6b3

æ¯Žå›žæ¤œç´¢ã—ç›´ã—ã¦ã€ã‚ã¡ã“ã¡ç¢ºèªã—ã¦ã„ã‚‹ã®ã§å‚™å¿˜éŒ²çš„ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚

## ã¯ã˜ã‚ã«

å˜ç™ºã§ç¢ºèªã—ãŸã„ã ã‘ãªã‚‰ã€GAã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚Œã°ã‚ˆã„ã§ã™ãŒã€

 - å®šæœŸçš„ã«æ›´æ–°ã—ãŸã„
 - GAã§è¡¨ç¤ºã§ãã‚‹ã‚ˆã‚Šã‚‚ç´°ã‹ã„æƒ…å ±ã‚’å–ã‚ŠãŸã„
 - å–ã‚ŠãŸã„æ•°å­—ã®ãƒªã‚¹ãƒˆãŒã‚ã‚Šã€æ‰‹ä½œæ¥­ã§é›†ã‚ã‚‹ã®ã¯å¤§å¤‰

ã¨ã„ã£ãŸã¨ãã«ã¯ã‚¢ãƒ‰ã‚ªãƒ³ã®Google AnalyticsãŒä½¿ãˆã¾ã™ã€‚

â†“ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã€ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚¢ãƒ‰ã‚ªãƒ³ã‹ã‚‰èµ·å‹•ã§ãã¾ã™ã€‚
https://gsuite.google.com/u/0/marketplace/app/google_analytics/477988381226?hl=ja&pann=sheets_addon_widget

## æœ€åˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
Create new reportã‚’æŠ¼ã—ãŸã¨ãã«ã§ã‚‹ã¨ã“ã‚ã€‚

![screenshot](https://storage.googleapis.com/zenn-user-upload/4c0d5e3a021d8e71c1699084.png)

ã“ã®è¾ºã¯ç”»é¢ã«å¾“ã£ã¦å…¥åŠ›ã™ã‚Œã°ã»ã¨ã‚“ã©ã„ã‘ã‚‹ã¨ã¯æ€ã„ã¾ã™ãŒã€æ…£ã‚Œãªã„ã†ã¡ã¯3)ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³æŒ‡å®šãŒè‹¥å¹²æˆ¸æƒ‘ã„ã¾ã™ã€‚

- Metrics : å‡ºã—ãŸã„æ•°å­— (ä¾‹ï¼šPageviews,sessions,BounceRate ãªã©)
- Dimensions : å‡ºã—ãŸã„å˜ä½ (ä¾‹ï¼šæ—¥ã”ã¨ãªã‚‰date,ãƒšãƒ¼ã‚¸ã”ã¨ãªã‚‰page ãªã©ã€‚è¦ã¯group by~~)
- Segments : ã©ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã™ã‚‹ã‹ (ä¾‹ï¼šæ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰New Users,æ¤œç´¢çµŒç”± Search Traffic ãªã©ã€‚å…¨éƒ¨ãªã‚‰ç©ºæ¬„ã§OK)


æ³¨æ„ã™ã¹ãã¯ *ã€ŒMetricsã¨Dimensionã®å˜ä½ã‚’ã‚ã‚ã›ã¦ãŠã‹ãªã„ã¨ã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã¨ãšã‚Œã‚‹ã€* ã“ã¨ã€‚
ä¾‹ãˆã°å›žéŠæ€§ã‚’è¡¨ã™ãƒšãƒ¼ã‚¸/ã‚»ãƒƒã‚·ãƒ§ãƒ³(Pages/Session)ã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³å˜ä½ã§è¨ˆæ¸¬ã•ã‚Œã‚‹ãŸã‚ã€ `Dimensions` ã«ã¯ `Landing Page` ã‚’é¸ã¶å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä¸€æ–¹PVã¯Pageå˜ä½ãªã®ã§ã€ä¸¡æ–¹ã®æ•°å€¤ã‚’å‡ºã—ãŸã„å ´åˆã¯ãƒ¬ãƒãƒ¼ãƒˆã‚’2ã¤ä½œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚åƒ•ã¯ã‚ˆãé–“é•ãˆã‚‹ã®ã§æ°—ã‚’ã¤ã‘ã¾ã—ã‚‡ã†(æ•°å­—ã‚ã£ã¡ã‚ƒãšã‚Œã¾ã™)

## æœ¬é¡Œ
å•é¡Œã¯Create Reportã‚’æŠ¼ã—ãŸå¾Œã®ã“ã“ã€‚
å¾Œã‹ã‚‰é …ç›®ã‚’è¶³ã—ãŸããªã£ãŸã‚Šã€ãƒ•ã‚£ãƒ«ã‚¿ã‚’ã‹ã‘ãŸããªã£ãŸå ´åˆã¯ã€æ‰‹æ‰“ã¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
![screenshot](https://storage.googleapis.com/zenn-user-upload/8c4c6536a8f0e569b74ca953.png)

èª¬æ˜Žã¯ã“ã“ã«ã‚ã‚‹ã®ãŒä¸€ç•ªã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ãŒã€é•·ã„ã®ã§ä»¥ä¸‹ã¾ã¨ã‚ã€‚
https://developers.google.com/analytics/devguides/reporting/core/v3/reference#filters

### Start Date / End Date

æ—¥ä»˜ã‚’å…¥ã‚Œã‚Œã°ã‚ˆã„ã€‚é–¢æ•°ã§ `=today()-29` ã¨ã‹ã—ã¦ãŠã‘ã°å®šæœŸæ›´æ–°ã‚’ã‹ã‘ã‚‹ã¨ãä¾¿åˆ©ã€‚
ç‰¹æ®Šãªã‚„ã¤ã ã¨ã€ `today` , `yesterday` , `Ndaysago` ãŒã‚ã‚‹ã‚‰ã—ã„ã§ã™ã€‚

è©³ã—ãã¯ã“ã®æ®µè½
https://developers.google.com/analytics/devguides/reporting/core/v3/reference#startDate

### Metrics

ã‚«ãƒ³ãƒžã§ã¤ãªã„ã§å…¥ã‚Œã¦ãã€‚

è©³ã—ãã¯ã“ã“ã€‚æ¤œç´¢ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚Œã°ga:xxxã®å½¢ã§å‡ºã—ã¦ãã‚Œã¾ã™ã€‚
https://ga-dev-tools.appspot.com/dimensions-metrics-explorer/

ä¸»ã ã£ãŸã¨ã“ã‚ã¯

ã‚»ãƒƒã‚·ãƒ§ãƒ³ç³»

|æŒ‡æ¨™|ã‚³ãƒ¼ãƒ‰|
|:--|:--|
|ã‚»ãƒƒã‚·ãƒ§ãƒ³|ga:sessions|
|ç›´å¸°çŽ‡|ga:bounceRate|
|ãƒšãƒ¼ã‚¸/ã‚»ãƒƒã‚·ãƒ§ãƒ³|ga:pageviewsPerSession|
|ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“|ga:avgSessionDuration|

PVç³»

|æŒ‡æ¨™|ã‚³ãƒ¼ãƒ‰|
|:--|:--|
|PV|ga:pageviews|
|æ»žåœ¨æ™‚é–“|ga:avgTimeOnPage|
|é›¢è„±çŽ‡|ga:exitRate|

### Dimensions

MetricsåŒæ§˜ã€è©³ã—ãã¯ã“ã¡ã‚‰ã€‚
https://ga-dev-tools.appspot.com/dimensions-metrics-explorer/

ä¸»ã ã£ãŸã¨ã“ã‚ã¯ `ga:date` ã¨ã‹ `ga:pagePath` ã¨ã‹ã€‚æœˆåˆ¥ã«å‡ºã™ã¨ãã¯ `year` ã¨ `month` ã®2ã¤ã‚’ä»˜ã‘ã¦ã„ã¾ã™ã€‚(ã¡ãªã¿ã«`Month of Year`ã¯ `202008` ã®ã‚ˆã†ã«è¿”ã£ã¦ãã¾ã™)

### Order

ãƒ‡ãƒ•ã‚©ãŒæ˜‡é †ã€‚é™é †ã«ã™ã‚‹ã«ã¯ `-ga:date` ã®ã‚ˆã†ã«ãƒžã‚¤ãƒŠã‚¹ã‚’ã¤ã‘ã‚‹ã€‚Metrixã®æŒ‡æ¨™ã‹ã‚‰å¤§ä½“é¸ã‚“ã§ã¾ã™ã€‚
è¤‡æ•°ã‚‚å¯èƒ½ã§ `ga:date,-ga:pageviews` ã®ã‚ˆã†ã«æ›¸ã‘ã°å·¦ã‚’å„ªå…ˆã—ã¤ã¤ã€åæ˜ ã—ã¦ãã‚Œã¾ã™ã€‚

è©³ã—ãã¯ã“ã®æ®µè½
https://developers.google.com/analytics/devguides/reporting/core/v3/reference#sort

### Filters

ä¸€ç•ªè¿·ã†ã¨ã“ã‚ã€‚ã“ã®æ®µè½ã‹ã‚‰ãŒã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã™ã€‚
https://developers.google.com/analytics/devguides/reporting/core/v3/reference#filterOperators

ä»¥ä¸‹ã‚ˆãä½¿ã†ã‚‚ã®ã®æŠœç²‹
ã‚·ãƒ¼ãƒˆä¸Šã§æ‰±ã†åˆ†ã«ã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãªã©ã¯åŸºæœ¬çš„ã«ä¸è¦ãªã®ã§çœç•¥ã—ã¦ã„ã¾ã™ã€‚

| æ¼”ç®—å­ | èª¬æ˜Ž | ä¾‹ | ã‚³ãƒ¼ãƒ‰ä¾‹ |
|:--|:--|:--|:--|
| == | æ¬¡ã¨ç­‰ã—ã„ | PVãŒã¡ã‚‡ã†ã© 1000ã§ã‚ã‚‹çµæžœã‚’è¿”ã™ | ga:pageView==1000 |
| > | ä¸Šå›žã‚‹ | PVãŒ1000ã‚ˆã‚Šå¤§ãã„çµæžœã‚’è¿”ã™ | ga:pageView>1000 |
| < | ä¸‹å›žã‚‹ | PVãŒ1000ã‚ˆã‚Šå¤§ãã„çµæžœã‚’è¿”ã™ | ga:pageView<1000 |
| >= | ä»¥ä¸Š | PVãŒ1000ä»¥ä¸Šã®çµæžœã‚’è¿”ã™ | ga:pageView>=1000 |
| <= | ä»¥ä¸‹ | PVãŒ1000ä»¥ä¸‹ã®çµæžœã‚’è¿”ã™ | ga:pageView<=1000 |

| æ¼”ç®—å­ | èª¬æ˜Ž | ä¾‹ | ã‚³ãƒ¼ãƒ‰ä¾‹ |
|:--|:--|:--|:--|
| == | å®Œå…¨ä¸€è‡´ | ãƒšãƒ¼ã‚¸ã®pathãŒ/12345ã«ä¸€è‡´ã™ã‚‹ã‚‚ã®ã‚’è¿”ã™ | ga:pagePath==/12345 |
| != | ä¸€è‡´ã—ãªã„ | ãƒšãƒ¼ã‚¸ã®pathãŒ/12345ã«ä¸€è‡´ã—ãªã„ã‚‚ã®ã‚’è¿”ã™ | ga:pagePath!=/12345 |
| =@ | æ–‡å­—åˆ—ã®ä¸€éƒ¨ã«ä¸€è‡´ | ãƒšãƒ¼ã‚¸ã®pathã«/123ãŒå«ã¾ã‚Œã‚‹ã‚‚ã®ã‚’è¿”ã™ | ga:pagePath=@/123 |
| !@ | æ–‡å­—åˆ—ã®ä¸€éƒ¨ã«ä¸€è‡´ã—ãªã„ | ãƒšãƒ¼ã‚¸ã®pathã«/123ãŒå«ã¾ã‚Œãªã„ã‚‚ã®ã‚’è¿”ã™ | ga:pagePath!@/123 |
| =~ | æ­£è¦è¡¨ç¾ã®ä¸€è‡´ã‚’å«ã‚€ | ãƒšãƒ¼ã‚¸ã®pathãŒ `/æ•°å­—` ã®ã¿ã®ã‚‚ã®ã‚’è¿”ã™ | ga:pagePath=~^/[0-9]+?$ |
| !~ | æ¬¡ã®æ­£è¦è¡¨ç¾ã«ä¸€è‡´ã™ã‚‹å ´åˆã‚’é™¤ã | ãƒšãƒ¼ã‚¸ã®pathãŒ `/æ•°å­—` ã§ãªã„ã‚‚ã®ã‚’è¿”ã™ | ga:pagePath!~^/[0-9]+?$ |

`/1234` ã®ã‚ˆã†ã« `/æ•°å­—` ã®è¨˜äº‹ã ã‘ã‚’å–ã‚Šå‡ºã—ãŸã„ã¨ãã¯æ­£è¦è¡¨ç¾ã‚’ä½¿ã£ã¦ `ga:pagePath=~^/[0-9]+?$` ã¨è¡¨ã‚ã›ã¾ã™ã€‚(ã“ã‚Œä¸€ç•ªä¾¿åˆ©)

ORæ¡ä»¶ã¯ `,` ã§ã¤ãªãŽã€ANDæ¡ä»¶ã¯ `;` ã§ã¤ãªãŽã¾ã—ã‚‡ã†ã€‚
ãŸã¨ãˆã°pagePathãŒ `/1234` ã‹ `/4321` ã®ã‚‚ã®ã«çµžã‚‹ã¨ãã¯
`ga:pagePath==/1234,ga:pagePath==/4321` ã¨ã™ã‚Œã°å¤§ä¸ˆå¤«ã§ã™ã€‚

### Segments

ã‚ã‚“ã¾ã‚Šä½¿ã‚ãªã„ã®ã§è©³ã—ããªã„ã§ã™ãŒã€æœ€åˆã®ç”»é¢ã§æ¤œç´¢ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«çµžã£ã¦ã¿ã‚‹ã¨ `gaid::-13` ã¨ã‚³ãƒ¼ãƒ‰ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
ã‚ã‹ã‚Šã«ãã„æ™‚ã¯ã€ `segment=sessions::condition::ga:medium%3D%3Dreferral` ã®ã‚ˆã†ã«æ”¹å¤‰ã‚‚ã§ãã‚‹ã‚ˆã†ã§ã™ã€‚

å‚ç…§
https://developers.google.com/analytics/devguides/reporting/core/v3/reference#segment

æ§‹æ–‡ã®ä½œã‚Šæ–¹ã¯â†“ãŒå‚è€ƒã«ãªã‚Šãã†ã§ã™ã€‚
https://developers.google.com/analytics/devguides/reporting/core/v3/segments-feature-reference

ãŸã ã€ã‚ã‚“ã¾ã‚Šç´°ã‹ã™ãŽã‚‹ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãŒã‹ã‹ã‚Šæ­£ã—ã„æ•°å­—ã§ã¯ãªããªã‚‹ã®ã§æ³¨æ„ã—ãŸã»ã†ãŒã‚ˆã•ãã†ã§ã™ã€‚


#### ãŠã—ã¾ã„

ç–²ã‚ŒãŸã®ã§ã“ã‚Œã§ãŠã—ã¾ã„
